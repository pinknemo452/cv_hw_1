# ЛР1 — Фильтр Собеля

**Цель работы:**
Научиться реализовывать простой алгоритм обработки изображений — фильтр Собеля — в двух вариантах (с использованием библиотек и нативно), сравнить быстродействие и оформить отчёт.

---

## Содержание репозитория

* `Sobel.ipynb` — ноутбук с реализацией (OpenCV + нативная реализация на Python), измерением времени и примерами.
* `README.md` — этот файл (инструкции и отчёт)

---

## 1. Теоретическая база

Фильтр Собеля — оператор краёв, приближает градиент интенсивности изображения. Применяется для выделения границ. Основные понятия:

* **Ядра Собеля (горизонтальный и вертикальный):**

  Горизонтальный (Gx):

  ```text
  [-1 0 1
   -2 0 2
   -1 0 1]
  ```

  Вертикальный (Gy):

  ```text
  [-1 -2 -1
    0  0  0
    1  2  1]
  ```

* **Градиент:**

  * Модуль градиента: `G = sqrt(Gx^2 + Gy^2)` или приближённо `|Gx| + |Gy|`.
  * Направление градиента: `theta = arctan2(Gy, Gx)`.

* **Предобработка:**

  * Преобразование в градации серого: `Y = 0.299 R + 0.587 G + 0.114 B`.
  * При необходимости размытие (гауссовский фильтр) для подавления шума.

---

## 2. Описание разработанной системы

### 2.1. Задачи, реализованные в ноутбуке

1. Загрузка изображения и приведение к оттенкам серого.
2. Реализация фильтра Собеля двумя способами:

   * **С использованием OpenCV**: `cv2.Sobel` или `cv2.filter2D` с ядрами Собеля.
   * **Нативная реализация (Python + NumPy)**: реализация свёртки (convolution) вручную (векторизованно при помощи NumPy) с обработкой граничных эффектов (zero padding / replicate).
3. Вычисление модуля градиента и направления.
4. Пороговая обработка / нормализация для визуализации.
5. Измерение быстродействия (время выполнения) для обоих вариантов — повторение выполнения N раз и усреднение.
6. Построение графиков времени выполнения и сохранение результатов.

### 2.2. Принципы работы

* Вход: цветное изображение или уже серое.
* Для корректного сравнения оба варианта используют одну и ту же предобработку и одинаковые входные данные.
* Время измеряется только для участка данных, реализующего ядро фильтрации и подсчёт градиента (без I/O и отрисовки), чтобы сравнение было честным.
* Для нативной реализации применяется векторизованная свёртка (через срезы/строки), либо — для наглядности — реализована функция свёртки в чистом Python (медленный вариант) и в NumPy (ускоренный нативный вариант).

---

## 3. Результаты работы и тестирования системы

### 3.1. Ожидаемые закономерности

* Реализация на OpenCV (которая использует оптимизированный C/C++ код) будет значительно быстрее нативной Python-реализации, особенно на больших изображениях.
* Векторизованная нативная реализация через NumPy (`convolve2d_numpy`) покажет лучшую производительность, чем чисто-питоновские циклы, но всё равно уступит OpenCV.
* Разница во времени будет увеличиваться с ростом размера изображения.

### 3.2. Результаты работы программы
Самописный вариант:
<img width="906" height="683" alt="image" src="https://github.com/user-attachments/assets/82652dcf-30aa-40f7-80e4-b45407a4679a" />
<img width="198" height="38" alt="image" src="https://github.com/user-attachments/assets/0222714c-bc15-40c2-9c30-e753bf19fff4" />

Библиотечный вариант:
<img width="905" height="688" alt="image" src="https://github.com/user-attachments/assets/ed92078e-9a1c-4a94-ab1a-30bb6d498329" />
<img width="214" height="34" alt="image" src="https://github.com/user-attachments/assets/42ccb6a1-bef5-412b-a48f-e2bab9bc15d5" />



---

## 4. Выводы по работе

* В ходе лабораторной работы получен опыт реализации оператора Собеля двумя способами: библиотечным и нативным.
* Эксперименты показали, что реализация на OpenCV быстрее на несколько порядков по сравнению с нативной реализацией.
* Для реальных задач следует использовать оптимизированные библиотеки (OpenCV) либо компилируемые расширения (Cython, Numba) при необходимости нативной логики.
* Нативная реализация полезна для понимания алгоритма и образовательных целей; при этом её можно оптимизировать (векторизация, многопоточность).

---

## 5. Использованные источники

* Richard Szeliski. *Computer Vision: Algorithms and Applications* — разделы по выделению границ.
* Документация OpenCV: описание `cv2.Sobel` и `cv2.filter2D`.
* Wikipedia: Sobel operator.
* Примеры и учебные материалы по реализации свёртки в NumPy.
